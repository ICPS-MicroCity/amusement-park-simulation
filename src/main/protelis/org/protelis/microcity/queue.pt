module org:protelis:microcity:queue

import microcity.entities.Entities.visitor
import microcity.Queues.visitorUnionForQueue
import microcity.Queues.updateWaitingTime
import microcity.Devices.getCurrentTime

// Update the waiting time of the visitor in a queue.
rep (time <- getCurrentTime()) {
    updateWaitingTime(time)
    getCurrentTime()
}

// Each visitor sends its information to the attractions in its neighborhood.
// Attractions create their queue looking for visitors on their coordinates.
share (field <- visitor()) {
    foldHoodPlusSelf(field, { a, b -> visitorUnionForQueue(a, b) })
}
